@tailwind base;
@tailwind components;
@tailwind utilities;

@layer base {
  :root {
    /* ===============================================
       PENNY CENTRAL â€“ DESIGN SYSTEM
       60-30-10 Rule: Neutral-Brand-CTA
       Clean, professional, WCAG AA compliant
       =============================================== */

    /* 60% - NEUTRAL BASE (backgrounds, text) */
    --bg-primary: #ffffff;
    --bg-secondary: #f8f8f7;
    --bg-dark: #1c1917;

    /* WCAG AA compliant text colors */
    --text-primary: #1c1917;
    --text-secondary: #44403c;
    --text-muted: #6b6560;
    --text-inverse: #fafaf9;

    --border-default: #e7e5e4;
    --border-dark: #78716c;

    /* 30% - BRAND COLORS (headers, accents, icons) */
    --brand-gunmetal: #374151;
    --brand-gunmetal-light: #4b5563;
    --brand-copper: #b87333;
    --brand-bronze: #cd7f32;

    /* 10% - CTA ACCENT (clickable buttons ONLY) */
    --cta-primary: #1d4ed8;
    --cta-hover: #1e40af;
    --cta-text: #ffffff;

    /* SYSTEM COLORS */
    --color-success: #16a34a;
    --color-warning: #d97706;
    --color-error: #dc2626;
    --color-info: #2563eb;

    /* Page backgrounds */
    --bg-page: #ffffff;
    --bg-card: #ffffff;
    --bg-elevated: #f8f8f7;

    /* Legacy variables for compatibility */
    --accent: #374151;
    --accent-hover: #1c1917;
    --accent-muted: #f5f5f4;
    --accent-emphasis: #1c1917;

    /* Shadow for cards */
    --shadow-card: 0 1px 3px rgba(0, 0, 0, 0.08);

    /* Status colors - functional only */
    --success: #16a34a;
    --error: #dc2626;
    --warning: #d97706;

    /* shadcn/ui compatibility */
    --background: var(--bg-page);
    --foreground: var(--text-primary);
    --card: var(--bg-card);
    --card-foreground: var(--text-primary);
    --popover: var(--bg-card);
    --popover-foreground: var(--text-primary);
    --primary: var(--cta-primary);
    --primary-foreground: #ffffff;
    --secondary: var(--bg-elevated);
    --secondary-foreground: var(--text-primary);
    --muted: var(--bg-elevated);
    --muted-foreground: var(--text-muted);
    --accent-foreground: #ffffff;
    --destructive: var(--error);
    --destructive-foreground: #ffffff;
    --border: var(--border-default);
    --input: var(--border-default);
    --ring: var(--cta-primary);
    --radius: 0.5rem;
  }

  .dark {
    /* Dark mode backgrounds - more separation between layers */
    --bg-page: #171412;
    --bg-card: #231f1c;
    --bg-elevated: #2e2926;

    /* Dark mode text - WCAG AA compliant */
    --text-primary: #fafaf9;
    --text-secondary: #d6d3d1;
    --text-muted: #a8a29e;

    /* Dark mode borders */
    --border-default: #3d3835;
    --border-dark: #5c5550;

    /* Dark mode brand */
    --brand-gunmetal: #9ca3af;
    --brand-gunmetal-light: #d1d5db;

    /* Dark mode CTA - slightly adjusted for visibility */
    --cta-primary: #3b82f6;
    --cta-hover: #60a5fa;

    /* Legacy compatibility */
    --accent: #9ca3af;
    --accent-hover: #d1d5db;
    --accent-muted: rgba(156, 163, 175, 0.15);
    --accent-emphasis: #fafaf9;

    --shadow-card: 0 1px 3px rgba(0, 0, 0, 0.4);

    /* shadcn/ui compatibility - dark */
    --background: var(--bg-page);
    --foreground: var(--text-primary);
    --card: var(--bg-card);
    --card-foreground: var(--text-primary);
    --popover: var(--bg-card);
    --popover-foreground: var(--text-primary);
    --secondary: var(--bg-elevated);
    --secondary-foreground: var(--text-primary);
    --muted: var(--bg-elevated);
    --muted-foreground: var(--text-muted);
    --border: var(--border-default);
    --input: var(--border-default);
    --ring: var(--cta-primary);
  }

  * {
    @apply border-border;
  }

  body {
    @apply bg-background text-foreground;
    font-family:
      var(--font-inter),
      -apple-system,
      BlinkMacSystemFont,
      sans-serif;
    font-size: 16px;
    line-height: 1.6;
    color: var(--text-primary);
    -webkit-font-smoothing: antialiased;
  }

  /* ===============================================
     ACCESSIBILITY: LINKS - WCAG AAA Compliant
     Body text links MUST be underlined by default.
     Navigation and buttons use other visual cues.
     =============================================== */

  /* Prose links (paragraphs, articles) - ALWAYS underlined */
  .guide-article a,
  article a,
  p a,
  .prose a {
    color: var(--cta-primary);
    text-decoration: underline;
    text-underline-offset: 0.15em;
    text-decoration-thickness: 1px;
    font-weight: 500;
    transition: text-decoration-thickness 0.15s ease;
  }

  .guide-article a:hover,
  article a:hover,
  p a:hover,
  .prose a:hover {
    text-decoration-thickness: 2px;
  }

  /* Focus ring for accessibility - all interactive elements */
  a:focus-visible,
  button:focus-visible,
  [role="button"]:focus-visible,
  input:focus-visible,
  select:focus-visible,
  textarea:focus-visible {
    outline: 2px solid var(--cta-primary);
    outline-offset: 2px;
  }

  /* ===============================================
     MINIMUM FONT SIZE: 12px
     Ensure no text is smaller than 12px for accessibility
     =============================================== */
  .text-xs {
    font-size: 0.75rem !important; /* 12px minimum */
    line-height: 1.5;
  }

  /* Override any 10px or smaller text */
  .text-\[10px\],
  .text-\[11px\],
  .text-\[8px\] {
    font-size: 0.75rem !important; /* Force to 12px minimum */
    line-height: 1.5;
  }

  code,
  .sku,
  .code {
    font-family: ui-monospace, monospace;
    font-size: 14px;
  }

  .caption,
  figcaption {
    font-size: 12px; /* Minimum 12px */
    color: var(--text-muted);
  }
}

@layer components {
  /* ===============================================
     GUIDE ARTICLE STYLES
     =============================================== */
  .guide-article {
    @apply text-slate-700 dark:text-slate-300;
  }

  .guide-article p {
    @apply mb-4 leading-relaxed;
  }

  .guide-article ul {
    @apply mb-6 ml-6 space-y-2 list-disc;
  }

  .guide-article li {
    @apply leading-relaxed;
  }

  .guide-article strong {
    @apply text-slate-900 dark:text-white font-semibold;
  }

  /* Section Headings */
  .section-heading {
    @apply text-xl font-semibold text-slate-900 dark:text-white mb-6 pb-3 border-b border-slate-200 dark:border-slate-700;
  }

  .lead {
    @apply text-lg text-stone-600 dark:text-stone-300 mb-6;
  }

  /* ===============================================
     CALLOUT BOXES
     =============================================== */
  .callout {
    @apply rounded-xl p-5 mb-6 border;
  }

  .callout-sky {
    @apply bg-sky-50 dark:bg-sky-950/30 border-sky-200 dark:border-sky-800;
  }

  .callout-amber {
    @apply bg-amber-50 dark:bg-amber-950/30 border-amber-200 dark:border-amber-800;
  }

  .callout-emerald {
    @apply bg-emerald-50 dark:bg-emerald-950/30 border-emerald-200 dark:border-emerald-800;
  }

  .callout-rose {
    @apply bg-rose-50 dark:bg-rose-950/30 border-rose-200 dark:border-rose-800;
  }

  .callout-compact {
    @apply p-4;
  }

  /* ===============================================
     PRICE CHIPS
     =============================================== */
  .price-chip {
    @apply inline-flex items-center px-2.5 py-0.5 rounded-md text-sm font-mono font-medium;
    @apply bg-slate-100 dark:bg-slate-800 text-slate-700 dark:text-slate-300;
  }

  /* ===============================================
     STEP CARDS (for numbered steps)
     =============================================== */
  .step-card {
    @apply relative pl-10 py-3;
  }

  .step-badge {
    @apply absolute left-0 top-3 w-7 h-7 rounded flex items-center justify-center text-xs font-bold;
    @apply bg-slate-200 dark:bg-slate-700 text-slate-700 dark:text-slate-300;
  }

  /* ===============================================
     INFO CARDS
     =============================================== */
  .info-card {
    @apply bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-lg p-4;
  }

  .info-card-header {
    @apply flex items-center gap-2.5 mb-2;
  }

  .info-card-icon {
    @apply w-8 h-8 rounded flex items-center justify-center;
    @apply bg-slate-100 dark:bg-slate-700 text-slate-600 dark:text-slate-400;
  }

  .info-card-title {
    @apply text-sm font-semibold text-slate-900 dark:text-white;
  }

  /* ===============================================
     TABLES ENHANCEMENT
     =============================================== */
  .guide-article table {
    @apply w-full mb-8 rounded-lg overflow-hidden border border-slate-200 dark:border-slate-700;
  }

  .guide-article thead {
    @apply bg-slate-50 dark:bg-slate-800/50;
  }

  .guide-article th {
    @apply text-left px-4 py-3 text-xs font-semibold text-slate-600 dark:text-slate-300 uppercase tracking-wider;
  }

  .guide-article td {
    @apply px-4 py-3 text-sm border-t border-slate-100 dark:border-slate-700/50;
  }

  .guide-article tbody tr {
    @apply bg-white dark:bg-slate-800 hover:bg-slate-50 dark:hover:bg-slate-700/50 transition-colors;
  }

  /* ===============================================
     STATUS BADGES
     =============================================== */
  .status-high {
    @apply text-emerald-600 dark:text-emerald-400 font-medium;
  }

  .status-medium {
    @apply text-amber-600 dark:text-amber-400 font-medium;
  }

  .status-low {
    @apply text-rose-600 dark:text-rose-400 font-medium;
  }

  /* ===============================================
     PRIORITY BADGES (WCAG AA compliant)
     =============================================== */
  .priority-badge {
    @apply inline-flex items-center px-2 py-0.5 rounded text-xs font-medium;
  }

  .priority-badge.high {
    @apply bg-emerald-100 dark:bg-emerald-900/40 text-emerald-700 dark:text-emerald-300;
  }

  .priority-badge.medium {
    @apply bg-amber-100 dark:bg-amber-900/40 text-amber-700 dark:text-amber-300;
  }

  .priority-badge.low {
    @apply bg-slate-100 dark:bg-slate-800 text-slate-600 dark:text-slate-400;
  }

  .priority-badge.penny {
    @apply bg-emerald-100 dark:bg-emerald-900/40 text-emerald-700 dark:text-emerald-300;
  }

  /* ===============================================
     LEAFLET MAP POPUP OVERRIDES
     Ensures popup is always visible, high contrast,
     and consistent with the design system.
     =============================================== */

  /* Popup container styling - Light mode */
  .leaflet-popup-content-wrapper {
    @apply bg-white rounded-xl shadow-lg border border-slate-200;
    padding: 0;
    overflow: hidden;
  }

  .leaflet-popup-content {
    margin: 14px 16px;
    line-height: 1.5;
    font-size: 14px; /* Minimum 12px, using 14px for readability */
    color: #0f172a; /* slate-900 */
  }

  /* Popup tip (arrow) styling - Light mode */
  .leaflet-popup-tip-container {
    margin-top: -1px;
  }

  .leaflet-popup-tip {
    @apply bg-white border border-slate-200;
    box-shadow: none;
  }

  /* Close button styling - Light mode */
  .leaflet-popup-close-button {
    color: #64748b !important; /* slate-500 */
    font-size: 20px !important;
    font-weight: 400 !important;
    width: 28px !important;
    height: 28px !important;
    top: 8px !important;
    right: 8px !important;
    padding: 0 !important;
    display: flex !important;
    align-items: center;
    justify-content: center;
    border-radius: 6px;
    transition:
      background-color 0.15s ease,
      color 0.15s ease;
  }

  .leaflet-popup-close-button:hover {
    color: #0f172a !important; /* slate-900 */
    background-color: #f1f5f9 !important; /* slate-100 */
  }

  /* ===============================================
     DARK MODE POPUP OVERRIDES
     =============================================== */
  .dark .leaflet-popup-content-wrapper {
    @apply bg-slate-800 border-slate-700;
  }

  .dark .leaflet-popup-content {
    color: #f8fafc; /* slate-50 */
  }

  .dark .leaflet-popup-tip {
    @apply bg-slate-800 border-slate-700;
  }

  .dark .leaflet-popup-close-button {
    color: #94a3b8 !important; /* slate-400 */
  }

  .dark .leaflet-popup-close-button:hover {
    color: #f8fafc !important; /* slate-50 */
    background-color: #334155 !important; /* slate-700 */
  }

  /* Ensure popup links have clear hover states */
  .store-popup-link {
    text-decoration: none;
    transition:
      color 0.15s ease,
      text-decoration 0.15s ease;
  }

  .store-popup-link:hover {
    text-decoration: underline;
  }

  /* Prevent popup from hugging edges - add margin to popup pane */
  .leaflet-popup {
    margin-bottom: 10px;
  }
}
